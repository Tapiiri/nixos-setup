#!/usr/bin/env -S python3
"""Executable entrypoint for `rebuild`.

This file is meant to be runnable as a standalone executable (including via
`sudo rebuild`). When installed or symlinked into a PATH directory, Python's
import path won't include the repo checkout. To keep things maintainable and
testable, we keep the implementation in `scripts_py.rebuild` and bootstrap the
import path here.
"""

from __future__ import annotations

import sys


def _bootstrap() -> None:
    # Bootstrapping cannot import scripts_py until sys.path is fixed.
    from pathlib import Path

    here = Path(__file__).resolve()
    sys.path.insert(0, str(here.parent.parent))

    from scripts_py.utils import RepoMarkers, bootstrap_repo_import_path

    bootstrap_repo_import_path(script_file=here, markers=RepoMarkers())


_bootstrap()

from scripts_py.rebuild import main  # noqa: E402


if __name__ == "__main__":
    raise SystemExit(main())
